---
layout: null
---
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Classifying Animal Behaviours with Uncertainty</title>
  <link rel="stylesheet" href="style.css">

  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

  <div class="content">
    <h1>Conformal Prediction to Classify Animal Behaviours with Uncertainty</h1>
    
    <div class="authors">
      <span class="author-block">Medha Agarwal<sup>1</sup>,</span>
      <span class="author-block">Kasim Rafiq<sup>2,3</sup>,</span>
      <span class="author-block">Ronak Mehta<sup>1</sup>,</span>
      <span class="author-block">Briana Abrahms<sup>2,3</sup>,</span>
      <span class="author-block">Zaid Harchaoui<sup>1</sup></span>
    </div>
    
    <div class="affiliations">
      <span><sup>1</sup>University of Washington (Statistics), <sup>2</sup>University of Washington (Biology), <sup>3</sup>Botswana Predator Conservation</span>
    </div>

    <div class="links" style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
      <a href="https://www.biorxiv.org/content/10.1101/2024.12.28.630628v2.full.pdf" class="btn">Paper</a>
      <a href="https://github.com/medhaaga/AWD-Biologging" class="btn">Code</a>
      <a href="https://zenodo.org/records/16890491" class="btn">Dataset</a>
    </div>

    <div class="teaser">
      <div class="figure-row">
        <img src="static/raps.png" alt="RAPS">
        <p class="caption">
          Regularized adaptive prediction sets (RAPS) with a target coverage of 95% ($1-\alpha=0.95$) for a random samples from each class. The numbers associated with each behaviour in the prediction set are the model predicted probability of success of that class.
        </p>
      </div>
    </div>

    <div class="section">
    <h2>Highlights</h2>
    <ul>
        <li>
        Accelerometers, which measure changes in acceleration across planes of movement, are increasingly being used to classify animal behaviours across taxa.
        However, practitioners face challenges like sparsely labeled data with <u>class imbalance, noisy data, distribution shift, and unquantified uncertainty</u>.
        </li>
        <li>
        We <u>introduce an open-source pipeline that integrates 1D Convolutional Neural Networks (CNNs) with Conformal Prediction (CP)</u> to produce statistically valid prediction sets for animal behavior.
        </li>
        <li>
        Our approach includes a <u>flexible class rebalancing</u> strategy that significantly improves the detection of rare, ecologically important behaviors.
        </li>
        <li>
        We evaluate our approach via simulation and highlight its utility using data collected from a free-ranging large carnivore, <u>African wild dogs</u> (<em>Lycaon pictus</em>), in the Okavango Delta, Botswana.
        </li>
    </ul>
    </div>

    <div class="section">
    <h2>Challenges of Behavior Prediction in Ecology</h2>
    <p>
        Accelerometers capture waveform patterns corresponding to specific movements, but translating these into reliable behavioral logs is difficult. Current ML applications in ecology face four main limitations:
    </p>
    <ul>
        <li>
        <b>Sparse and imbalanced labels:</b> Ecological datasets are often dominated by common behaviors (e.g., Resting). In our dataset, minority classes like Feeding and Running comprised only ~6% of the data.
        </li>
        <li>
        <b>Uncertainty quantification:</b> Most models output a single "best guess" without indicating confidence, which can be misleading for ambiguous behaviors.
        </li>
        <li>
        <b>Distribution shifts:</b> Models trained on specific individuals or time periods often degrade when applied to new contexts (e.g., different years or animals).
        </li>
        <li>
        <b>Temporal inconsistency:</b> Frame-by-frame classifiers often produce rapid, biologically impossible fluctuations in predicted behavior.
        </li>
    </ul>
    </div>

    <div class="section">
      <h2>Methodology</h2>

      <h3> Feature Extraction & Class Rebalancing </h3>
      <p>
      We use a 1D CNNs to extract features from raw accelerometry data. To address the severe class imbalance (e.g., 66% Resting vs 2% Feeding), 
      we employ a flexible class rebalancing approach parametrized by $\theta$. This allows us to interpolate between the original distribution ($\theta=0$) 
      and a perfectly balanced uniform distribution ($\theta=1$), optimizing for the detection of rare events.
      </p>

      <div class="figure-row">
        <div style="display: flex; justify-content: center; gap: 20px; align-items: center;">
            <img src="static/cnn.png" alt="CNN Architecture" style="max-width: 48%; height: auto;">
            <img src="static/confusion.png" alt="Second Image Description" style="max-width: 48%; height: auto;"> 
        </div>

        <p class="caption">
            <strong>Left:</strong> Our 1D CNN architecture extracts features from raw tri-axial accelerometer data.
            <strong>Right:</strong> Confusion matrices showing that our rebalancing approach improves recall on the rare <i>Feeding</i> class from 0.62 to 0.97.
        </p>
      </div>

      <h3> Uncertainty Quantification via Conformal Prediction </h3>
      
      <p>
      Standard neural networks output softmax scores that often do not reflect true probabilities. To address this, we apply <strong>Regularized Adaptive Prediction Sets (RAPS)</strong>. 
      This method calibrates the model using a held-out validation set to generate prediction sets $\mathcal{C}(X)$. These sets are guaranteed to contain the true behavior $y$ with a user-specified probability $1-\alpha$ (e.g., 95%). 
      This allows ecologists to identify ambiguous data segments where the model is uncertain.
      </p>

      <h3> Temporal Smoothning </h3>

      <p>
      To mitigate noisy, rapid fluctuations in predictions, we implement a temporal smoothing step. We average softmax scores over a sliding window of size $s$, 
      leveraging the temporal context of surrounding behaviors to enforce biological plausibility.
      </p>

        <div class="teaser">
            <img src="static/temporal_smoothening.gif" 
                alt="Temporal Smoothing Animation" 
                style="width: 100%; height: auto; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
            
            <p class="caption">
                <strong>Temporal Smoothing in Action:</strong> Raw model predictions (top) fluctuate rapidly. Our smoothing pipeline (bottom) 
                uses temporal context to output biologically plausible behaviour transitions.
            </p>
        </div>
    </div>

    


    <div class="section">
      <h2>Citation</h2>
      <pre><code>@article{agarwal2025leveraging,
        title={Leveraging machine learning and accelerometry to classify animal behaviours with uncertainty},
        author={Agarwal, Medha and Rafiq, Kasim and Mehta, Ronak and Abrahms, Briana and Harchaoui, Zaid},
        booktitle={Methods in Ecology and Evolution (MEE)},
        year={2025}
        }</code></pre>
    </div>

  </div>
</body>
</html>